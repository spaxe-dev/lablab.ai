<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LabLab.ai - AI-Powered Code Intelligence</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#6366f1',
                        secondary: '#8b5cf6',
                        accent: '#06b6d4',
                        dark: '#0f172a',
                        'dark-light': '#1e293b',
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.6s ease-out',
                        'pulse-glow': 'pulseGlow 2s infinite',
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes pulseGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(99, 102, 241, 0.3); }
            50% { box-shadow: 0 0 30px rgba(99, 102, 241, 0.6); }
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .hover-lift {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .hover-lift:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 min-h-screen text-white">
    <!-- Navigation -->
    <nav class="glass-effect border-b border-white/10 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-2">
                        <div class="w-8 h-8 bg-gradient-to-r from-primary to-secondary rounded-lg flex items-center justify-center">
                            <i class="fas fa-brain text-white text-sm"></i>
                        </div>
                        <h1 class="text-xl font-bold bg-gradient-to-r from-white to-gray-300 bg-clip-text text-transparent">
                            LabLab.ai
                        </h1>
                    </div>
                    <span class="text-xs bg-primary/20 text-primary-light px-2 py-1 rounded-full">
                        AI-Powered Code Intelligence
                    </span>
                </div>
                <div class="flex items-center space-x-6">
                    <button class="nav-link active" data-page="dashboard">
                        <i class="fas fa-chart-line mr-2"></i>Dashboard
                    </button>
                    <button class="nav-link" data-page="dependency-health">
                        <i class="fas fa-shield-alt mr-2"></i>Dependencies
                    </button>
                    <button class="nav-link" data-page="pr-reviews">
                        <i class="fas fa-code-branch mr-2"></i>PR Reviews
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- Dashboard Page -->
        <div id="dashboard-page" class="page active">
            <!-- Hero Section -->
            <div class="text-center mb-12 animate-fade-in">
                <h2 class="text-4xl font-bold mb-4 bg-gradient-to-r from-white via-purple-200 to-cyan-200 bg-clip-text text-transparent">
                    AI-Powered Code Intelligence Platform
                </h2>
                <p class="text-gray-300 text-lg max-w-3xl mx-auto">
                    Advanced dependency analysis, AI-powered PR reviews, and intelligent code quality monitoring for modern development teams.
                </p>
            </div>

            <!-- Stats Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
                <div class="glass-effect rounded-2xl p-6 hover-lift animate-slide-up">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-gradient-to-r from-green-400 to-green-600 rounded-xl flex items-center justify-center">
                            <i class="fas fa-check-circle text-white text-xl"></i>
                        </div>
                        <span class="text-green-400 text-sm font-medium">+12%</span>
                    </div>
                    <h3 class="text-2xl font-bold text-white" id="healthy-deps">--</h3>
                    <p class="text-gray-400 text-sm">Healthy Dependencies</p>
                </div>

                <div class="glass-effect rounded-2xl p-6 hover-lift animate-slide-up" style="animation-delay: 0.1s">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-gradient-to-r from-yellow-400 to-yellow-600 rounded-xl flex items-center justify-center">
                            <i class="fas fa-exclamation-triangle text-white text-xl"></i>
                        </div>
                        <span class="text-yellow-400 text-sm font-medium">-8%</span>
                    </div>
                    <h3 class="text-2xl font-bold text-white" id="vulnerable-deps">--</h3>
                    <p class="text-gray-400 text-sm">Vulnerable Dependencies</p>
                </div>

                <div class="glass-effect rounded-2xl p-6 hover-lift animate-slide-up" style="animation-delay: 0.2s">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-gradient-to-r from-primary to-secondary rounded-xl flex items-center justify-center">
                            <i class="fas fa-code-branch text-white text-xl"></i>
                        </div>
                        <span class="text-primary text-sm font-medium">+24%</span>
                    </div>
                    <h3 class="text-2xl font-bold text-white" id="pr-reviews">42</h3>
                    <p class="text-gray-400 text-sm">AI PR Reviews</p>
                </div>

                <div class="glass-effect rounded-2xl p-6 hover-lift animate-slide-up" style="animation-delay: 0.3s">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-gradient-to-r from-cyan-400 to-cyan-600 rounded-xl flex items-center justify-center">
                            <i class="fas fa-brain text-white text-xl"></i>
                        </div>
                        <span class="text-cyan-400 text-sm font-medium">98%</span>
                    </div>
                    <h3 class="text-2xl font-bold text-white">AI Accuracy</h3>
                    <p class="text-gray-400 text-sm">Code Quality Score</p>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
                <div class="glass-effect rounded-2xl p-8 hover-lift cursor-pointer animate-slide-up" onclick="showPage('dependency-health')">
                    <div class="w-16 h-16 bg-gradient-to-r from-green-400 to-green-600 rounded-2xl flex items-center justify-center mb-6 mx-auto">
                        <i class="fas fa-shield-alt text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-center mb-3">Dependency Health</h3>
                    <p class="text-gray-400 text-center text-sm mb-6">
                        Analyze your project dependencies for security vulnerabilities and outdated packages.
                    </p>
                    <div class="flex justify-center">
                        <button class="bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 px-6 py-2 rounded-lg text-white font-medium transition-all">
                            Check Dependencies
                        </button>
                    </div>
                </div>

                <div class="glass-effect rounded-2xl p-8 hover-lift cursor-pointer animate-slide-up" style="animation-delay: 0.1s" onclick="showPage('pr-reviews')">
                    <div class="w-16 h-16 bg-gradient-to-r from-primary to-secondary rounded-2xl flex items-center justify-center mb-6 mx-auto">
                        <i class="fas fa-code-branch text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-center mb-3">AI PR Reviews</h3>
                    <p class="text-gray-400 text-center text-sm mb-6">
                        Get intelligent code reviews powered by advanced AI models for better code quality.
                    </p>
                    <div class="flex justify-center">
                        <button class="bg-gradient-to-r from-primary to-secondary hover:from-purple-600 hover:to-purple-700 px-6 py-2 rounded-lg text-white font-medium transition-all">
                            View Reviews
                        </button>
                    </div>
                </div>

                <div class="glass-effect rounded-2xl p-8 hover-lift cursor-pointer animate-slide-up" style="animation-delay: 0.2s">
                    <div class="w-16 h-16 bg-gradient-to-r from-cyan-400 to-cyan-600 rounded-2xl flex items-center justify-center mb-6 mx-auto">
                        <i class="fas fa-chart-bar text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-center mb-3">Analytics</h3>
                    <p class="text-gray-400 text-center text-sm mb-6">
                        Deep insights into your codebase quality, trends, and team performance metrics.
                    </p>
                    <div class="flex justify-center">
                        <button class="bg-gradient-to-r from-cyan-500 to-cyan-600 hover:from-cyan-600 hover:to-cyan-700 px-6 py-2 rounded-lg text-white font-medium transition-all">
                            Coming Soon
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dependency Health Page -->
        <div id="dependency-health-page" class="page hidden">
            <div class="mb-8">
                <h2 class="text-3xl font-bold mb-4 bg-gradient-to-r from-white to-gray-300 bg-clip-text text-transparent">
                    Dependency Health Monitor
                </h2>
                <p class="text-gray-400">
                    Analyze your project dependencies for security vulnerabilities, outdated packages, and compliance issues.
                </p>
            </div>

            <!-- Analysis Input -->
            <div class="glass-effect rounded-2xl p-8 mb-8">
                <h3 class="text-xl font-bold mb-6">Analyze Dependencies</h3>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- GitHub Repository -->
                    <div>
                        <h4 class="text-lg font-semibold mb-4 flex items-center">
                            <i class="fab fa-github mr-2"></i>
                            GitHub Repository
                        </h4>
                        <div class="space-y-4">
                            <input 
                                type="text" 
                                id="github-repo" 
                                placeholder="owner/repository-name"
                                class="w-full bg-slate-800/50 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-primary transition-colors"
                            >
                            <button 
                                onclick="analyzeGitHubRepo()" 
                                class="w-full bg-gradient-to-r from-primary to-secondary hover:from-purple-600 hover:to-purple-700 px-6 py-3 rounded-lg text-white font-medium transition-all flex items-center justify-center"
                            >
                                <i class="fab fa-github mr-2"></i>
                                Analyze GitHub Repository
                            </button>
                        </div>
                    </div>

                    <!-- File Upload -->
                    <div>
                        <h4 class="text-lg font-semibold mb-4 flex items-center">
                            <i class="fas fa-file-upload mr-2"></i>
                            Upload Dependencies File
                        </h4>
                        <div class="space-y-4">
                            <div class="border-2 border-dashed border-slate-600 rounded-lg p-8 text-center">
                                <input 
                                    type="file" 
                                    id="file-upload" 
                                    accept=".json,.txt,.lock,.yaml,.yml"
                                    class="hidden"
                                    onchange="handleFileUpload(event)"
                                >
                                <label for="file-upload" class="cursor-pointer">
                                    <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                                    <p class="text-gray-400">Click to upload requirements.txt, package.json, or similar</p>
                                </label>
                            </div>
                            <button 
                                onclick="analyzeUploadedFile()" 
                                class="w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 px-6 py-3 rounded-lg text-white font-medium transition-all flex items-center justify-center"
                                disabled
                                id="analyze-file-btn"
                            >
                                <i class="fas fa-file-alt mr-2"></i>
                                Analyze Uploaded File
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Loading State -->
            <div id="loading-state" class="hidden glass-effect rounded-2xl p-12 text-center">
                <div class="animate-spin w-16 h-16 border-4 border-primary border-t-transparent rounded-full mx-auto mb-6"></div>
                <h3 class="text-xl font-bold mb-2">Analyzing Dependencies...</h3>
                <p class="text-gray-400">This may take a few moments while we scan for vulnerabilities and outdated packages.</p>
            </div>

            <!-- Results Section -->
            <div id="results-section" class="hidden">
                <!-- Summary Cards -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="glass-effect rounded-2xl p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="w-12 h-12 bg-gradient-to-r from-green-400 to-green-600 rounded-xl flex items-center justify-center">
                                <i class="fas fa-shield-alt text-white"></i>
                            </div>
                        </div>
                        <h3 class="text-2xl font-bold text-green-400" id="secure-count">0</h3>
                        <p class="text-gray-400 text-sm">Secure Dependencies</p>
                    </div>
                    
                    <div class="glass-effect rounded-2xl p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="w-12 h-12 bg-gradient-to-r from-yellow-400 to-yellow-600 rounded-xl flex items-center justify-center">
                                <i class="fas fa-exclamation-triangle text-white"></i>
                            </div>
                        </div>
                        <h3 class="text-2xl font-bold text-yellow-400" id="outdated-count">0</h3>
                        <p class="text-gray-400 text-sm">Outdated Packages</p>
                    </div>
                    
                    <div class="glass-effect rounded-2xl p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="w-12 h-12 bg-gradient-to-r from-red-400 to-red-600 rounded-xl flex items-center justify-center">
                                <i class="fas fa-bug text-white"></i>
                            </div>
                        </div>
                        <h3 class="text-2xl font-bold text-red-400" id="vulnerable-count">0</h3>
                        <p class="text-gray-400 text-sm">Vulnerabilities Found</p>
                    </div>
                </div>

                <!-- Detailed Results -->
                <div class="glass-effect rounded-2xl p-8">
                    <h3 class="text-xl font-bold mb-6">Dependency Analysis Results</h3>
                    <div id="dependency-results"></div>
                </div>
            </div>
        </div>

        <!-- PR Reviews Page -->
        <div id="pr-reviews-page" class="page hidden">
            <div class="mb-8">
                <h2 class="text-3xl font-bold mb-4 bg-gradient-to-r from-white to-gray-300 bg-clip-text text-transparent">
                    AI-Powered PR Reviews
                </h2>
                <p class="text-gray-400">
                    Intelligent code reviews powered by advanced AI models for better code quality and faster development.
                </p>
            </div>

            <!-- Coming Soon -->
            <div class="glass-effect rounded-2xl p-16 text-center">
                <div class="w-24 h-24 bg-gradient-to-r from-primary to-secondary rounded-full flex items-center justify-center mx-auto mb-8">
                    <i class="fas fa-code-branch text-white text-3xl"></i>
                </div>
                <h3 class="text-2xl font-bold mb-4">AI PR Review Dashboard</h3>
                <p class="text-gray-400 mb-8 max-w-2xl mx-auto">
                    The AI PR Review dashboard is currently in development. Soon you'll be able to view all your PR reviews, 
                    track code quality metrics, and manage your AI-powered review settings from this interface.
                </p>
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <button class="bg-gradient-to-r from-primary to-secondary hover:from-purple-600 hover:to-purple-700 px-8 py-3 rounded-lg text-white font-medium transition-all">
                        Configure GitHub App
                    </button>
                    <button class="bg-slate-700 hover:bg-slate-600 px-8 py-3 rounded-lg text-white font-medium transition-all">
                        View Documentation
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="border-t border-white/10 mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="text-center text-gray-400">
                <p>&copy; 2025 LabLab.ai - AI-Powered Code Intelligence Platform</p>
                <p class="text-sm mt-2">Built for the LabLab.ai Hackathon 2025</p>
            </div>
        </div>
    </footer>    <script>
        // Configuration - Multiple API endpoints for redundancy
        const API_ENDPOINTS = {
            // Primary: Direct dependency health service
            dependency_health: 'https://dependency-health.onrender.com',
            // Fallback: Next.js backend
            backend: 'https://stackhub-backend.onrender.com/api/dependency-health',
            // Local development
            local: 'http://localhost:8001'
        };
        
        let currentAPI = API_ENDPOINTS.dependency_health;
        
        // Test API connectivity and switch if needed
        async function testAPIConnectivity() {
            const endpoints = Object.values(API_ENDPOINTS);
            
            for (const endpoint of endpoints) {
                try {
                    const response = await fetch(`${endpoint}/health`, { 
                        method: 'GET',
                        timeout: 5000 
                    });
                    if (response.ok) {
                        currentAPI = endpoint;
                        console.log(`âœ… Connected to API: ${endpoint}`);
                        return endpoint;
                    }
                } catch (error) {
                    console.log(`âŒ Failed to connect to: ${endpoint}`);
                }
            }
            
            console.warn('âš ï¸ No API endpoints available');
            return null;
        }
        
        // Initialize API connection on page load
        document.addEventListener('DOMContentLoaded', function() {
            testAPIConnectivity();
            
            // Add animation delays
            const cards = document.querySelectorAll('.animate-slide-up');
            cards.forEach((card, index) => {
                card.style.animationDelay = `${index * 0.1}s`;
            });
        });
        
        // Page Navigation
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.add('hidden');
                page.classList.remove('active');
            });
            
            // Show selected page
            const targetPage = document.getElementById(pageId + '-page');
            if (targetPage) {
                targetPage.classList.remove('hidden');
                targetPage.classList.add('active');
            }
            
            // Update navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            document.querySelector(`[data-page="${pageId}"]`).classList.add('active');
        }

        // Navigation event listeners
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                const pageId = e.target.closest('button').dataset.page;
                showPage(pageId);
            });
        });

        // GitHub Repository Analysis
        async function analyzeGitHubRepo() {
            const repoInput = document.getElementById('github-repo');
            const repo = repoInput.value.trim();
            
            if (!repo || !repo.includes('/')) {
                alert('Please enter a valid GitHub repository (owner/repo)');
                return;
            }

            showLoading();
            
            // Ensure API connectivity
            await testAPIConnectivity();
            
            const endpoints = [
                `${currentAPI}/check-github`,
                `${API_ENDPOINTS.backend}/check-github`,
                `${API_ENDPOINTS.dependency_health}/check-github`
            ];
            
            for (const endpoint of endpoints) {
                try {
                    console.log(`ðŸ” Trying: ${endpoint}`);
                    
                    const response = await fetch(endpoint, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ 
                            repo_url: `https://github.com/${repo}`,
                            repo: repo // Some APIs might expect just the repo name
                        })
                    });

                    const data = await response.json();
                    
                    if (response.ok) {
                        console.log('âœ… GitHub analysis successful:', data);
                        displayResults(data);
                        return;
                    } else {
                        console.warn(`âŒ ${endpoint} failed:`, data);
                        throw new Error(data.detail || data.message || 'Analysis failed');
                    }
                } catch (error) {
                    console.error(`âŒ Error with ${endpoint}:`, error);
                    continue; // Try next endpoint
                }
            }
            
            hideLoading();
            alert('Error: All API endpoints failed. Please check the repository name and try again.');
        }

        // File Upload Analysis
        function handleFileUpload(event) {
            const file = event.target.files[0];
            const analyzeBtn = document.getElementById('analyze-file-btn');
            
            if (file) {
                analyzeBtn.disabled = false;
                analyzeBtn.classList.remove('opacity-50');
            } else {
                analyzeBtn.disabled = true;
                analyzeBtn.classList.add('opacity-50');
            }
        }

        async function analyzeUploadedFile() {
            const fileInput = document.getElementById('file-upload');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('Please select a file to analyze');
                return;
            }

            showLoading();

            // Ensure API connectivity
            await testAPIConnectivity();

            const formData = new FormData();
            formData.append('file', file);

            const endpoints = [
                `${currentAPI}/check-file`,
                `${API_ENDPOINTS.backend}/check-file`,
                `${API_ENDPOINTS.dependency_health}/check-file`
            ];

            for (const endpoint of endpoints) {
                try {
                    console.log(`ðŸ” Trying file upload: ${endpoint}`);
                    
                    const response = await fetch(endpoint, {
                        method: 'POST',
                        body: formData
                    });

                    const data = await response.json();
                    
                    if (response.ok) {
                        console.log('âœ… File analysis successful:', data);
                        displayResults(data);
                        return;
                    } else {
                        console.warn(`âŒ ${endpoint} failed:`, data);
                        throw new Error(data.detail || data.message || 'Analysis failed');
                    }
                } catch (error) {
                    console.error(`âŒ Error with ${endpoint}:`, error);
                    continue; // Try next endpoint
                }
            }
            
            hideLoading();
            alert('Error: All API endpoints failed. Please check your file and try again.');
        }

        // UI Helper Functions
        function showLoading() {
            document.getElementById('loading-state').classList.remove('hidden');
            document.getElementById('results-section').classList.add('hidden');
        }

        function hideLoading() {
            document.getElementById('loading-state').classList.add('hidden');
        }

        function displayResults(data) {
            hideLoading();
            
            console.log('ðŸ“Š Displaying results:', data);
            
            // Handle different response formats
            let dependencies = [];
            if (data.dependencies) {
                dependencies = data.dependencies;
            } else if (data.results) {
                dependencies = data.results;
            } else if (Array.isArray(data)) {
                dependencies = data;
            }
            
            // Update summary cards
            const secure = dependencies.filter(dep => 
                dep.status === 'secure' || dep.status === 'safe' || dep.vulnerabilities_count === 0
            ).length;
            const outdated = dependencies.filter(dep => 
                dep.status === 'outdated' || dep.needs_update
            ).length;
            const vulnerable = dependencies.filter(dep => 
                dep.status === 'vulnerable' || (dep.vulnerabilities_count && dep.vulnerabilities_count > 0)
            ).length;
            
            document.getElementById('secure-count').textContent = secure;
            document.getElementById('outdated-count').textContent = outdated;
            document.getElementById('vulnerable-count').textContent = vulnerable;
            
            // Update dashboard stats
            document.getElementById('healthy-deps').textContent = secure;
            document.getElementById('vulnerable-deps').textContent = vulnerable;
            
            // Display detailed results
            const resultsContainer = document.getElementById('dependency-results');
            resultsContainer.innerHTML = generateResultsHTML(data, dependencies);
            
            // Show results section
            document.getElementById('results-section').classList.remove('hidden');
        }

        function generateResultsHTML(originalData, dependencies) {
            if (!dependencies || dependencies.length === 0) {
                return `
                    <div class="text-center py-12">
                        <i class="fas fa-search text-gray-400 text-4xl mb-4"></i>
                        <p class="text-gray-400 mb-4">No dependencies found to analyze.</p>
                        <details class="text-left bg-slate-800/30 rounded-lg p-4">
                            <summary class="cursor-pointer text-sm font-medium text-gray-300 mb-2">Debug Info</summary>
                            <pre class="text-xs text-gray-400 overflow-auto">${JSON.stringify(originalData, null, 2)}</pre>
                        </details>
                    </div>
                `;
            }

            let html = '<div class="space-y-4">';
            
            dependencies.forEach(dep => {
                // Handle different response formats
                const name = dep.name || dep.package_name || dep.dependency?.name || 'Unknown';
                const version = dep.version || dep.current_version || dep.dependency?.version || 'Unknown';
                const latest = dep.latest_version || dep.newest_version || 'Unknown';
                
                // Determine status
                let status = 'unknown';
                let statusColor = 'gray';
                let statusIcon = 'question';
                
                if (dep.status) {
                    status = dep.status;
                } else if (dep.vulnerabilities_count > 0) {
                    status = 'vulnerable';
                } else if (dep.needs_update) {
                    status = 'outdated';
                } else {
                    status = 'secure';
                }
                
                switch (status) {
                    case 'secure':
                    case 'safe':
                        statusColor = 'green';
                        statusIcon = 'shield-alt';
                        break;
                    case 'outdated':
                    case 'needs_update':
                        statusColor = 'yellow';
                        statusIcon = 'exclamation-triangle';
                        break;
                    case 'vulnerable':
                    case 'danger':
                        statusColor = 'red';
                        statusIcon = 'bug';
                        break;
                }
                
                // Get vulnerabilities
                const vulnerabilities = dep.vulnerabilities || dep.security_issues || [];
                
                html += `
                    <div class="bg-slate-800/30 rounded-xl p-6 border border-slate-700">
                        <div class="flex items-start justify-between">
                            <div class="flex items-start space-x-4">
                                <div class="w-10 h-10 bg-gradient-to-r from-${statusColor}-400 to-${statusColor}-600 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-${statusIcon} text-white"></i>
                                </div>
                                <div>
                                    <h4 class="text-lg font-semibold text-white">${name}</h4>
                                    <p class="text-gray-400">Current: ${version}</p>
                                    ${latest !== 'Unknown' ? `<p class="text-gray-400">Latest: ${latest}</p>` : ''}
                                </div>
                            </div>
                            <span class="px-3 py-1 rounded-full text-xs font-medium bg-${statusColor}-500/20 text-${statusColor}-400">
                                ${status.toUpperCase()}
                            </span>
                        </div>
                        ${vulnerabilities.length > 0 ? `
                            <div class="mt-4 pt-4 border-t border-slate-700">
                                <h5 class="text-sm font-medium text-red-400 mb-2">
                                    <i class="fas fa-exclamation-triangle mr-1"></i>
                                    Vulnerabilities (${vulnerabilities.length}):
                                </h5>
                                <ul class="space-y-1">
                                    ${vulnerabilities.slice(0, 3).map(vuln => `
                                        <li class="text-sm text-gray-300">
                                            â€¢ ${vuln.title || vuln.description || vuln.summary || 'Security vulnerability found'}
                                        </li>
                                    `).join('')}
                                    ${vulnerabilities.length > 3 ? `
                                        <li class="text-sm text-gray-400">
                                            â€¢ ... and ${vulnerabilities.length - 3} more
                                        </li>
                                    ` : ''}
                                </ul>
                            </div>
                        ` : ''}
                        ${dep.description ? `
                            <div class="mt-4 pt-4 border-t border-slate-700">
                                <p class="text-sm text-gray-400">${dep.description}</p>
                            </div>
                        ` : ''}
                    </div>
                `;
            });
            
            html += '</div>';
            
            // Add debug info
            html += `
                <div class="mt-8 pt-6 border-t border-slate-700">
                    <details class="bg-slate-800/30 rounded-lg p-4">
                        <summary class="cursor-pointer text-sm font-medium text-gray-300 mb-2">
                            <i class="fas fa-bug mr-1"></i>
                            Debug: Raw API Response
                        </summary>
                        <pre class="text-xs text-gray-400 overflow-auto mt-2">${JSON.stringify(originalData, null, 2)}</pre>
                    </details>
                </div>
            `;
            
            return html;
        }
    </script>

    <style>
        .nav-link {
            @apply px-4 py-2 rounded-lg text-gray-300 hover:text-white hover:bg-white/10 transition-all duration-200 flex items-center;
        }
        .nav-link.active {
            @apply bg-primary/20 text-primary-light;
        }
        .page {
            @apply animate-fade-in;
        }
        .page.hidden {
            @apply opacity-0 pointer-events-none;
        }
    </style>
</body>
</html>
